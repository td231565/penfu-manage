(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ea90fcc"],{"3de4":function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return s})),n.d(e,"j",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"i",(function(){return f})),n.d(e,"g",(function(){return h})),n.d(e,"b",(function(){return g}));var i=n("5530"),a=n("b775");function o(t,e,n){return Object(a["a"])({url:"car/list/order_status/",method:"post",data:Object(i["a"])({page:t,numberPerPage:e},n)})}function r(t,e){return Object(a["a"])({url:"car/list/",method:"post",data:{page:t,numberPerPage:e}})}function s(){return Object(a["a"])({url:"locate/",method:"get"})}function c(t){return Object(a["a"])({url:"car_order/return/write_off/backend/",method:"post",data:{orderID:t}})}function l(t){return Object(a["a"])({url:"car/",method:"post",data:Object(i["a"])(Object(i["a"])({},t),{},{status:1})})}function u(t){var e=t.id,n=t.title,i=t.lastLocate,o=t.status,r=t.category;return Object(a["a"])({url:"car/".concat(e),method:"patch",data:{title:n,lastLocate:i,category:r,status:o}})}function d(t){return Object(a["a"])({url:"car/".concat(t),method:"delete"})}function f(t){var e=t.title,n=t.address,i=t.lng,o=t.lat;return Object(a["a"])({url:"locate/",method:"post",data:{title:e,address:n,lng:i,lat:o,status:1}})}function h(t){var e=t.id,n=t.title,i=t.address,o=t.lng,r=t.lat,s=t.status;return Object(a["a"])({url:"locate/".concat(e),method:"patch",data:{title:n,address:i,lng:o,lat:r,status:s}})}function g(t){return Object(a["a"])({url:"locate/".concat(t),method:"delete"})}},f5ce:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"app-container"},[n("el-card",{staticClass:"w-100 rouned-3"},[n("div",{staticClass:"d-flex justify-content-between align-items-center mb-4"},[n("h5",{staticClass:"my-0"},[t._v("車輛列表")]),n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.showModal()}}},[t._v("新增車輛")])],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{label:"車輛 ID",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.id)+" ")]}}])}),n("el-table-column",{attrs:{label:"出租 ID",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.orderID)+" ")]}}])}),n("el-table-column",{attrs:{label:"車輛名稱",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.title)+" ")]}}])}),n("el-table-column",{attrs:{label:"車種",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.bikeCategories.find((function(t){var n=t.id;return e.row.category===n})).title)+" ")]}}])}),n("el-table-column",{attrs:{label:"當前位置",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.lastLocate)+" ")]}}])}),n("el-table-column",{attrs:{label:"租借狀況",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(1===Number(e.row.status)?"空閒中":"租借中")+" ")]}}])}),n("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"編輯",placement:"top"}},[n("el-button",{attrs:{type:"text",size:"large"},on:{click:function(n){return t.showModal(e.row.id)}}},[n("i",{staticClass:"el-icon-edit"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"刪除",placement:"top"}},[n("el-button",{attrs:{type:"text",size:"large"},on:{click:function(n){return t.showRemoveConfirm(e.row.id)}}},[n("i",{staticClass:"el-icon-delete"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"顯示 QRCode",placement:"top"}},[n("el-button",{attrs:{type:"text",size:"large"},on:{click:function(n){return t.showQrcode(e.row.id)}}},[n("span",{staticClass:"material-symbols-outlined",staticStyle:{"font-size":"14px"}},[t._v(" qr_code ")])])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"查看合約",placement:"top"}},[n("el-button",{attrs:{type:"text",size:"large"},on:{click:function(n){return t.showContract(e.row.id)}}},[n("i",{staticClass:"el-icon-s-order"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"歸還",placement:"top"}},[n("el-button",{attrs:{type:"text",size:"large",disabled:1===Number(e.row.status)},on:{click:function(n){t.returnBike(e.row.orderID,1===Number(e.row.status))}}},[n("i",{staticClass:"el-icon-refresh-left"})])],1)]}}])})],1),n("div",{staticClass:"d-flex justify-content-end align-items-center mt-3"},[n("el-pagination",{attrs:{"current-page":t.page.current,"page-sizes":[10,30,50,100],"page-size":t.page.size,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"update:currentPage":function(e){return t.$set(t.page,"current",e)},"update:current-page":function(e){return t.$set(t.page,"current",e)},"current-change":function(e){return t.fetchData(e,t.page.size)},"size-change":function(e){return t.fetchData(1,e)}}})],1)],1),n("el-dialog",{attrs:{title:"新增車輛",visible:t.isShowModal,width:"60%","close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowModal=e}}},[n("el-form",{ref:"form",attrs:{model:t.bikeInfo,rules:t.formRules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"車輛名稱",prop:"title"}},[n("el-input",{attrs:{placeholder:"請輸入車輛名稱"},model:{value:t.bikeInfo.title,callback:function(e){t.$set(t.bikeInfo,"title",e)},expression:"bikeInfo.title"}})],1),n("el-form-item",{attrs:{label:"車輛地點",prop:"lastLocate"}},[n("el-select",{attrs:{placeholder:"請選擇"},model:{value:t.bikeInfo.lastLocate,callback:function(e){t.$set(t.bikeInfo,"lastLocate",e)},expression:"bikeInfo.lastLocate"}},t._l(t.locates,(function(t){return n("el-option",{key:t.id,attrs:{label:t.title,value:t.title}})})),1)],1),n("el-form-item",{attrs:{label:"車輛類型",prop:"category"}},[n("el-select",{attrs:{placeholder:"請選擇"},model:{value:t.bikeInfo.category,callback:function(e){t.$set(t.bikeInfo,"category",e)},expression:"bikeInfo.category"}},t._l(t.bikeCategories,(function(t){return n("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})})),1)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.hideModal}},[t._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.confirmModal}},[t._v("確認")])],1)],1),n("el-dialog",{attrs:{title:t.bikeInfo.title,visible:t.isShowQrcode,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowQrcode=e}}},[n("div",{staticClass:"d-flex justify-content-center"},[n("VueQrcode",{attrs:{value:t.bikeInfo.id,options:t.qrOptions}})],1),n("p",{staticClass:"text-center"},[t._v("請右鍵點擊下載")])]),n("el-dialog",{attrs:{title:t.bikeInfo.title,visible:t.isShowContract,width:"70%",top:"15px","close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowContract=e}}},[n("div",{staticClass:"d-flex justify-content-center"},[n("img",{attrs:{src:t.bikeInfo.contractImage,alt:""}})])])],1)},a=[],o=n("5530"),r=(n("d3b7"),n("d81d"),n("4de4"),n("e9c4"),n("159b"),n("7db0"),n("2f62")),s=n("b2e5"),c=n.n(s),l=n("3de4"),u={name:"BikeList",components:{VueQrcode:c.a},data:function(){return{list:[],locates:[],bikeCategories:[{id:"1",title:"自行車"},{id:"2",title:"親子車"},{id:"3",title:"電動車"}],listLoading:!0,isLoading:!1,isCheckAll:!1,isShowModal:!1,bikeInfo:{},isShowQrcode:!1,isShowContract:!1,qrOptions:{width:160,margin:0,scale:4},formRules:{title:[{required:!0,message:"請輸入名稱",trigger:"blur"}],lastLocate:[{required:!0,message:"請輸入地址",trigger:"blur"}],category:[{required:!0,message:"請選擇",trigger:"blur"}]},page:{current:1,size:10,total:0}}},computed:Object(o["a"])(Object(o["a"])({},Object(r["b"])(["bikePage"])),{},{isIndeterminate:function(){return this.list.some((function(t){var e=t.isCheck;return e}))&&!this.isCheckAll},checkedIdList:function(){return this.list.filter((function(t){var e=t.isCheck;return e})).map((function(t){var e=t.id;return e}))}}),created:function(){this.page=JSON.parse(JSON.stringify(this.bikePage));var t=this.page,e=t.current,n=t.size;this.fetchData(e,n),this.getAllLocates()},beforeDestroy:function(){this.SET_BIKE_PAGE(this.page)},methods:Object(o["a"])(Object(o["a"])({},Object(r["c"])("lists",["SET_BIKE_PAGE"])),{},{fetchData:function(t,e){var n=this;this.listLoading=!0,Object(l["c"])(t,e).then((function(e){n.list=e.car.map((function(t){return t.isCheck=!1,t})),n.page.current=t,n.page.total=e.total,n.listLoading=!1})).catch((function(t){console.log(t),n.listLoading=!1}))},getAllLocates:function(){var t=this;this.isLoading=!0,Object(l["d"])().then((function(e){t.locates=e.locate,t.isLoading=!1})).catch((function(e){console.log(e),t.isLoading=!1}))},updateBike:function(t){var e=this;this.isLoading=!0;var n="create"===t?l["h"]:l["f"];n(this.bikeInfo).then((function(n){e.hideModal(),e.isLoading=!1;var i="create"===t?"新增":"編輯";e.$message({type:"success",message:"".concat(i,"成功")});var a=e.page,o=a.current,r=a.size;e.fetchData(o,r)})).catch((function(t){console.log(t),e.isLoading=!1}))},returnBike:function(t,e){var n=this;e||this.$confirm("確定歸還此車輛嗎？","Warning",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(){n.listLoading=!0,Object(l["j"])(t).then((function(){var t=n.page,e=t.current,i=t.size;n.fetchData(e,i),n.listLoading=!1,n.$message({type:"success",message:"歸還成功"})})).catch((function(){n.listLoading=!1}))}))},removeBike:function(t){var e=this;this.listLoading=!0,Object(l["a"])(t).then((function(t){e.$message({type:"success",message:"刪除車輛成功"});var n=e.page,i=n.current,a=n.size;e.fetchData(i,a)})).catch((function(t){console.log(t),99===t.response.data.status&&e.$message.error("車子正被租借中，不可刪除"),e.listLoading=!1}))},checkAllRow:function(){var t=this;this.list.forEach((function(e){e.isCheck=t.isCheckAll}))},checkOneRow:function(t){this.isCheckAll=t&&this.list.every((function(t){var e=t.isCheck;return e}))},showRemoveConfirm:function(t){var e=this;this.$confirm("確定要刪除選擇的車輛嗎？","Warning",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(){e.removeBike(t)}))},confirmModal:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return t.$message.error("請確認必填欄位輸入完整"),!1;t.updateBike(t.bikeInfo.id?"update":"create")}))},showQrcode:function(t){this.bikeInfo=this.list.find((function(e){return e.id===t})),this.isShowQrcode=!0},showContract:function(t){this.bikeInfo=this.list.find((function(e){return e.id===t})),this.isShowContract=!0},showModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(t){var e=this.list.find((function(e){return e.id===t}));this.bikeInfo=JSON.parse(JSON.stringify(e))}this.isShowModal=!0},hideModal:function(){this.bikeInfo={},this.isShowModal=!1}})},d=u,f=n("2877"),h=Object(f["a"])(d,i,a,!1,null,"aff074c0",null);e["default"]=h.exports}}]);