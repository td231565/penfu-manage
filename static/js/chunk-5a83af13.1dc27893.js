(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a83af13"],{"25f0":function(t,e,n){"use strict";var a=n("6eeb"),o=n("825a"),l=n("d039"),r=n("ad6d"),i="toString",s=RegExp.prototype,c=s[i],u=l((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d=c.name!=i;(u||d)&&a(RegExp.prototype,i,(function(){var t=o(this),e=String(t.source),n=t.flags,a=String(void 0===n&&t instanceof RegExp&&!("flags"in s)?r.call(t):n);return"/"+e+"/"+a}),{unsafe:!0})},"3de4":function(t,e,n){"use strict";n.d(e,"e",(function(){return l})),n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"j",(function(){return s})),n.d(e,"h",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"i",(function(){return f})),n.d(e,"g",(function(){return g})),n.d(e,"b",(function(){return h}));var a=n("5530"),o=n("b775");function l(t,e,n){return Object(o["a"])({url:"car/list/order_status/",method:"post",data:Object(a["a"])({page:t,numberPerPage:e},n)})}function r(t,e){return Object(o["a"])({url:"car/list/",method:"post",data:{page:t,numberPerPage:e}})}function i(){return Object(o["a"])({url:"locate/",method:"get"})}function s(t){return Object(o["a"])({url:"car_order/return/write_off/backend/",method:"post",data:{orderID:t}})}function c(t){return Object(o["a"])({url:"car/",method:"post",data:Object(a["a"])(Object(a["a"])({},t),{},{status:1})})}function u(t){var e=t.id,n=t.title,a=t.lastLocate,l=t.status,r=t.category;return Object(o["a"])({url:"car/".concat(e),method:"patch",data:{title:n,lastLocate:a,category:r,status:l}})}function d(t){return Object(o["a"])({url:"car/".concat(t),method:"delete"})}function f(t){var e=t.title,n=t.address,a=t.lng,l=t.lat;return Object(o["a"])({url:"locate/",method:"post",data:{title:e,address:n,lng:a,lat:l,status:1}})}function g(t){var e=t.id,n=t.title,a=t.address,l=t.lng,r=t.lat,i=t.status;return Object(o["a"])({url:"locate/".concat(e),method:"patch",data:{title:n,address:a,lng:l,lat:r,status:i}})}function h(t){return Object(o["a"])({url:"locate/".concat(t),method:"delete"})}},"46ac":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"app-container"},[n("el-card",{staticClass:"w-100 rouned-3"},[n("div",{staticClass:"d-flex justify-content-between align-items-center mb-4"},[n("h5",{staticClass:"my-0"},[t._v("地點列表")]),n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.showModal()}}},[t._v("新增地點")])],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{label:"地點名稱",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.title)+" ")]}}])}),n("el-table-column",{attrs:{label:"地址",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.address)+" ")]}}])}),n("el-table-column",{attrs:{label:"座標",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("p",[t._v("經度："+t._s(e.row.lng))]),n("p",[t._v("緯度："+t._s(e.row.lat))])]}}])}),n("el-table-column",{attrs:{label:"操作",width:"75",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"編輯",placement:"top"}},[n("el-button",{attrs:{type:"text",size:"large"},on:{click:function(n){return t.showModal(e.row.id)}}},[n("i",{staticClass:"el-icon-edit"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"刪除",placement:"top"}},[n("el-button",{attrs:{type:"text",size:"large"},on:{click:function(n){return t.showRemoveConfirm(e.row.id)}}},[n("i",{staticClass:"el-icon-delete"})])],1)]}}])})],1)],1),n("el-dialog",{attrs:{title:"新增地點",visible:t.isShowModal,width:"60%","close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowModal=e}}},[n("el-form",{ref:"form",attrs:{model:t.locateInfo,rules:t.formRules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"地點名稱",prop:"title"}},[n("el-input",{attrs:{placeholder:"請輸入名稱"},model:{value:t.locateInfo.title,callback:function(e){t.$set(t.locateInfo,"title",e)},expression:"locateInfo.title"}})],1),n("el-form-item",{attrs:{label:"地點地址",prop:"address"}},[n("el-input",{attrs:{placeholder:"請輸入地址"},on:{blur:t.getLatLngByQuery},model:{value:t.locateInfo.address,callback:function(e){t.$set(t.locateInfo,"address",e)},expression:"locateInfo.address"}})],1),n("el-form-item",{attrs:{label:""}},[n("el-col",{staticClass:"text-center",attrs:{span:2}},[n("span",[t._v("Lat")])]),n("el-col",{attrs:{span:10}},[n("el-form-item",{attrs:{prop:"lat"}},[n("el-input",{attrs:{placeholder:"請輸入緯度"},model:{value:t.locateInfo.lat,callback:function(e){t.$set(t.locateInfo,"lat",e)},expression:"locateInfo.lat"}})],1)],1),n("el-col",{staticClass:"text-center",attrs:{span:2}},[n("span",[t._v("Lng")])]),n("el-col",{attrs:{span:10}},[n("el-form-item",{attrs:{prop:"lng"}},[n("el-input",{attrs:{placeholder:"請輸入經度"},model:{value:t.locateInfo.lng,callback:function(e){t.$set(t.locateInfo,"lng",e)},expression:"locateInfo.lng"}})],1)],1),n("el-col",{staticClass:"mt-3",attrs:{span:24}},[n("GmapMap",{staticStyle:{width:"500px",height:"300px"},attrs:{center:t.mapCenter,zoom:14,"map-type-id":"terrain"}},[n("GmapMarker",{attrs:{position:t.mapCenter,clickable:!0,draggable:!0},on:{dragend:t.setLatLng}})],1)],1)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.hideModal}},[t._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.confirmModal}},[t._v("確認")])],1)],1)],1)},o=[],l=(n("d3b7"),n("d81d"),n("4de4"),n("a9e3"),n("25f0"),n("159b"),n("7db0"),n("3de4")),r=n("755e"),i={name:"LocateList",data:function(){return{list:[],listLoading:!0,isLoading:!1,isCheckAll:!1,isShowModal:!1,locateInfo:{address:"",lat:22.445759,lng:120.473509},formRules:{title:[{required:!0,message:"請輸入名稱",trigger:"blur"}],lat:[{required:!0,message:"請輸入地址",trigger:"blur"}],lng:[{required:!0,message:"請輸入地址",trigger:"blur"}]},google:r["gmapApi"]}},computed:{isIndeterminate:function(){return this.list.some((function(t){var e=t.isCheck;return e}))&&!this.isCheckAll},checkedIdList:function(){return this.list.filter((function(t){var e=t.isCheck;return e})).map((function(t){var e=t.id;return e}))},mapCenter:{get:function(){var t=this.locateInfo,e=t.lat,n=t.lng;return{lat:Number(e),lng:Number(n)}},set:function(t){var e=t.lat,n=t.lng;this.locateInfo.lat=e,this.locateInfo.lng=n}}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;this.listLoading=!0,Object(l["d"])().then((function(e){t.list=e.locate.map((function(t){return t.isCheck=!1,t})),t.listLoading=!1})).catch((function(e){console.log(e),t.listLoading=!1}))},updateLocate:function(){var t=this;this.isLoading=!0;var e=!this.locateInfo.id,n=this.locateInfo,a=n.lat,o=n.lng;this.locateInfo.lat=a.toString(),this.locateInfo.lng=o.toString();var r=e?l["i"]:l["g"];r(this.locateInfo).then((function(n){t.hideModal(),t.locateInfo={address:"",lat:22.445759,lng:120.473509},t.isLoading=!1;var a=e?"新增":"編輯";t.$message({type:"success",message:"".concat(a,"地點成功")}),t.fetchData()})).catch((function(e){console.log(e),t.isLoading=!1}))},getLatLngByQuery:function(t){var e=this;if(t){var n=Object(r["gmapApi"])(),a=new n.maps.Geocoder;a.geocode({address:t},(function(t,n){if("OK"===n){var a=t[0].geometry.location,o=a.lat,l=a.lng;e.locateInfo.lat=o(),e.locateInfo.lng=l()}else e.$message.error("無法辨識輸入的地址或關鍵字")}))}},setLatLng:function(t){var e=t.latLng,n=e.lat,a=e.lng;this.locateInfo.lat=n(),this.locateInfo.lng=a()},removeLocate:function(t){var e=this;this.listLoading=!0,Object(l["b"])(t).then((function(t){e.$message({type:"success",message:"刪除地點成功"}),e.fetchData()})).catch((function(t){console.log(t),e.listLoading=!1}))},checkAllRow:function(){var t=this;this.list.forEach((function(e){e.isCheck=t.isCheckAll}))},checkOneRow:function(t){this.isCheckAll=t&&this.list.every((function(t){var e=t.isCheck;return e}))},showRemoveConfirm:function(t){var e=this;this.$confirm("確定要刪除選擇的地點嗎？","Warning",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(){e.removeLocate(t)}))},confirmModal:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return t.$message.error("請確認必填欄位輸入完整"),!1;t.updateLocate()}))},showModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t&&(this.locateInfo=this.list.find((function(e){return e.id===t}))),this.isShowModal=!0},hideModal:function(){this.locateInfo={address:"",lat:22.445759,lng:120.473509},this.isShowModal=!1}}},s=i,c=n("2877"),u=Object(c["a"])(s,a,o,!1,null,"56f8f938",null);e["default"]=u.exports},"7db0":function(t,e,n){"use strict";var a=n("23e7"),o=n("b727").find,l=n("44d2"),r=n("ae40"),i="find",s=!0,c=r(i);i in[]&&Array(1)[i]((function(){s=!1})),a({target:"Array",proto:!0,forced:s||!c},{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),l(i)}}]);